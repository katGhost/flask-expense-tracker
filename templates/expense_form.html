{% extends "layout.html" %}

{% block title %}
  {% if mode=="edit" %}
    Edit Expense
  {% else %}
    Add Expense
  {% endif %}
{% endblock %}

{% block main %}
  <div class="w-full max-w-2xl mx-auto px-4 py-6">

    <h3 class="mb-5 text-2xl font-semibold text-gray-900 dark:text-gray-100">
      {% if mode == "edit" %}
        Edit Expense
      {% else %}
        Add Expense
      {% endif %}
    </h3>

    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md">
      <form action="{% if mode == 'edit' %}/edit-expense/{{ expense.id }}{% else %}/add{% endif %}" method="POST">

        <!-- Income -->
        <div class="mb-4">
          <input value="{{ expense.income if expense else '' }}" autocomplete="off" autofocus class="form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-md p-3" name="income" placeholder="Income" type="number" step="0.01">
        </div>

        <!-- Expense -->
        <div class="mb-4">
          <input value="{{ expense.expense if expense else '' }}" autocomplete="off" class="form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-md p-3" name="expense" placeholder="Expense" type="text">
        </div>

        <!-- Merchant -->
        <div class="mb-4">
          <input value="{{ expense.merchant if expense else '' }}" autocomplete="off" class="form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-md p-3" name="merchant" placeholder="Merchant" type="text">
        </div>

        <!-- Category -->
        <div class="mb-4">
          <label class="block text-gray-700 dark:text-gray-200 font-medium">Category <span class="text-red-500">*</span></label>
          <select class="form-select w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-md p-3" name="category" required>
            {% for cat in categories %}
              <option value="{{ cat.name }}" {% if expense and expense.category.name == cat.name %}selected{% endif %}>{{ cat.name }}</option>
            {% endfor %}
          </select>
        </div>

        <!-- Amount & Currency -->
        <div class="mb-4 flex gap-4">
          <input value="{{ expense.amount if expense else '' }}" autocomplete="off" class="form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-md p-3" name="amount" placeholder="Amount" type="number">
          <select class="form-select w-32 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-md p-3" name="currency" required>
            <option value="zar">ZAR</option>
            <option value="usd">USD</option>
            <option value="euro">EURO</option>
          </select>
        </div>

        <!-- Submit Button -->
        <div class="flex gap-3 mb-4">
          <button type="submit" name="action" value="save_history" class="w-full py-3 bg-green-500 text-white rounded-md hover:bg-green-600 transition">
            {% if mode == "edit" %}
              Update Expense
            {% else %}
              Add Expense
            {% endif %}
          </button>
        </div>
        
      </form>
    </div>
  </div>
{% endblock %}
